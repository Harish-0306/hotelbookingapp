{% extends "layout.html" %}
{% block title %}All Hotels{% endblock %}
{% block content %}
<h2>Search Hotels</h2>
<form method="get">
    <input type="text" name="search" placeholder="Hotel name or location">
    <input type="date" name="checkin" required>
    <input type="date" name="checkout" required>
    <input type="number" name="guests" placeholder="Guests" min="1" required>
    <input type="number" name="rooms" placeholder="Rooms" min="1" required>

    <label>Room Type:</label>
    <select name="room_type">
        <option value="">Any</option>
        <option value="AC">AC</option>
        <option value="NON-AC">Non-AC</option>
    </select>

    <label>Price Range:</label><br>
Min: ₹<span id="min-price-display">1000</span>
<input type="range" name="min_price" id="min_price" min="1000" max="10000" value="1000" step="100">

<br>
Max: ₹<span id="max-price-display">100000</span>
<input type="range" name="max_price" id="max_price" min="1000" max="10000" value="10000" step="100">

<script>
    const minSlider = document.getElementById('min_price');
    const maxSlider = document.getElementById('max_price');
    const minDisplay = document.getElementById('min-price-display');
    const maxDisplay = document.getElementById('max-price-display');

    minSlider.addEventListener('input', () => {
        if (parseInt(minSlider.value) > parseInt(maxSlider.value)) {
            minSlider.value = maxSlider.value;
        }
        minDisplay.textContent = minSlider.value;
    });

    maxSlider.addEventListener('input', () => {
        if (parseInt(maxSlider.value) < parseInt(minSlider.value)) {
            maxSlider.value = minSlider.value;
        }
        maxDisplay.textContent = maxSlider.value;
    });
</script>


    <label>Needed Access:</label><br>
    <input type="checkbox" name="features" value="food"> Food
    <input type="checkbox" name="features" value="wifi"> Wi-Fi
    <input type="checkbox" name="features" value="pool"> Pool

    <br><br><button type="submit">Search</button>
</form>

{% if hotels %}
    {% for hotel in hotels %}
    <div>
        <h3><a href="{{ url_for('hotel_detail', hotel_id=hotel[0]) }}">{{ hotel[1] }}</a></h3>
        <p>{{ hotel[2] }}</p>
    </div>
    {% endfor %}
{% else %}
    <p>No hotels match your search criteria.</p>
{% endif %}

<script>
document.querySelector("form").addEventListener("submit", function(event) {
    const checkin = new Date(document.querySelector("input[name='checkin']").value);
    const checkout = new Date(document.querySelector("input[name='checkout']").value);
    if (checkout <= checkin) {
        alert("Check-out must be after check-in.");
        event.preventDefault();
    }
});
</script>
{% endblock %}
